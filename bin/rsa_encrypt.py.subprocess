#!/bin/zsh

# Encrypt AES-256-CBC


WD="$HOME/Developer/var"
m_file=$WD/message.txt
c_file=$WD/ciphertext.enc

# Get Key and IV
KEY=$( hx $WD/rsa.key )
IV=0

# Write the message to file
MESSAGE="$1"
printf '%s' "$MESSAGE" > $m_file

# Encrypt
openssl enc \
    -aes-256-cbc \
    -K "$KEY" \
    -iv $IV \
    -nosalt \
    -e \
    -in $m_file \
    -out $c_file


# Subprocess output
hx $c_file
return 0
