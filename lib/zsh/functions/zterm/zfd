#!/bin/zsh

#  zfd
#  zTerm (id: 56)
#
#  Generated by 'zfn' on 2020-10-22
#  Copyright Â© 2020 Maxim Puchkov. All rights reserved.


# zfd
#
# <#Description...#>
# @define command 1
#
# Usage:
# zfd
# <#usage...#>
emulate -LR zsh
autoload -Uz error pipeset


# @command      cd
# @description  Change working directory to function directory.
function zfd_cd() {
  local dir="$ZDOTDIR/functions"
  if [[ $# -gt 0 ]]; then
    dir+="/${argv}"
  fi
  print -P -- "%F{4}$dir%f"
  builtin cd $dir
  zfd_list
}


# @command      list
# @description  List autoload functions.
function zfd_list() {
  (builtin cd $ZDOTDIR/functions &&
  /bin/ls -ldr -og -Tt -- **/*(.))
}


# @command      find
# @description  Find autoload functions.
function zfd_find() {
  local name="${1}*"
  local -a files=()
  /usr/bin/find -- "$ZDOTDIR/functions"  \
    -name "${~name}" -mindepth 1 -type f \
    2>/dev/null |
  pipeset -a files
  
  if [[ ${#files} -eq 0 ]]; then
    error -1 -m 'no matches found for: ${name}'
  else
    print -oi -nr -C1 -- ${files}
    return 0
  fi
}


local subcommand="${1:=cd}"
shift
if [[ ${+functions[${0}_${subcommand}]} -eq 0 ]]; then
  error -127 -m 'no such command: ${subcommand}'
fi
${0}_${subcommand} ${argv}
