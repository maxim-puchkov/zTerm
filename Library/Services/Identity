#!/bin/zsh

#  Identity
#  com.maximpuchkov.services.Identity
#
#  Created by Maxim Puchkov on 2020-05-26.
#  Copyright Â© 2020 Maxim Puchkov. All rights reserved.


fpath=(/usr/local/Terminal/zsh/{site-,}functions $fpath)
autoload -Uz logf
logf 'Service started.'


# Key file
typeset key=~/.ssh/id_rsa
if ! ssh-add -T -- $key &>/dev/null; then
    logf 'Adding private key ${key}.'
    ssh-add -- $key
fi

# Check status
typeset -i return_code=$?
if [[ $return_code -eq 0 ]]; then
    logf -c 0 'Private key ${key} added successfully.'
else
    logf -c $return_code 'Failed to add key ${key}.'
fi


logf 'Service stopped.'
return $return_code



#MARK: - Diagram:

#   1. True
#   2. (1) is False
#   3. Therefore, True
