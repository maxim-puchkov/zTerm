#!/bin/zsh

#  tests
#  Z-Function (117)
#
#  Created by Maxim Puchkov on 2020-09-11.
#  Copyright Â© 2020 Maxim Puchkov. All rights reserved.


# <#Function description#>
function tests() {
  # Root directory path is stored in this parameter
  typeset var_name='TEST_ROOT_DIR'
  
  # If the path is not set, print error
  if [[ ! -v "$var_name" ]]; then
    error -1 -- 'Parameter ${var_name} is not set.'
    return 1
  fi
  
  # If the path is set but is not a directory, print error
  typeset var_value="${(P)var_name}"
  if [[ ! -d "$var_value" ]]; then
    error -1 -- 'No such directory: ${var_value}.'
    return 1
  fi
  
  
  
  
  # Create subdirectories '<Test Root Dir>/<Current Year>/<Current Month>'
  typeset current_year current_month
  current_year=$(date -j +'%Y')   # YYYY
  current_month=$(date -j +'%B')  # Full month name
  # For example, in April 2030 the directory is 'Test/2030/April'
  typeset current_subdir
  current_subdir="${(P)var_name}/${current_year}/${current_month}"
  
  
  
  # If current subdirectory does not exist, create it
  if [[ ! -d "$current_subdir" ]]; then
    if ! mkdir -p -- "$current_subdir"; then
      error -1 -- 'Cannot create directory: ${current_subdir}.'
      return 1
    fi
  fi
  
  
  
  Standout
  cd "$current_subdir"
#  echo "sub: $current_subdir"
}

#
#  if [[ ! -d "$current_subdir" ]]; then
#    error -1 --no-return -- 'No such directory: ${current_subdir}.'
#    if mkdir -p "$current_subdir"; then
#      print -- 'New test subdirectory created.'
#    else
#      error -1 'Cannot create directory: ${current_subdir}.'
#      return 1
#    fi
#  fi
#
#  red $current_subdir
#
#}
