#!/bin/zsh

#  it2
#  Z-Function (81)
#
#  Created by Maxim Puchkov on 2020-07-03.
#  Copyright Â© 2020 Maxim Puchkov. All rights reserved.


# Name:
#   it2
# Synopsis:
#   it2 [option...] [command]
# Description:
#   Create and customize iTerm2 windows.
function it2() {
  local -a profiles
  profiles=('Dark' 'Light')
  
  local prefix"=${ITERM_PROFILE%: *}: "
  local profile_name
  
  ## it2 set-profile
  function it2_set-profile() {
      profile_name="${prefix}${1#$prefix}"
      printf 'Setting iTerm2 profile to %s%b\n' \
             "${prefix}${profile_name}" \
             "\e]1337;SetProfile=${profile_name}\a" >&2
      export ITERM_PROFILE="${profile_name}"
      return 0
  }
  ## it2 switch-profile
  function it2_switch-profile() {
    local -i i=${profiles[(i)${ITERM_PROFILE#$prefix}]}
    let i="($i % ${#profiles}) + 1"
    profile_name="${profiles[$i]}"
    it2_set-profile "$profile_name"
  }
  
  
  typeset cmd=$1
  
  
  
  if [[ ${+functions[${0}_${cmd}]} -ne 1 ]]; then
    error -127 'invalid command: ${cmd}'
    fn print-help "$0"
    return 127
  fi
  shift
  ${0}_${cmd} $argv
  return $?
}
