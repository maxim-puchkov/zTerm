#!/bin/zsh

#  cutline
#  Z-Function (78)
#
#  Created by Maxim Puchkov on 2020-06-30.
#  Copyright Â© 2020 Maxim Puchkov. All rights reserved.


# <#Function description#>
function cutline() {
    function cutline_unordered() {
        while [[ -n $1 ]]; do
        n=$1 print-var n
            awk -v n=$1 '(NR == n)'
            shift
        done <&0
    }
    function cutline_ordered() {
        awk -v lines="$argv" '
            BEGIN {gsub(/[[:space:]]/, "|", lines);}
            (NR ~ lines)'
    }
    
    
    print-var @

#    cutline_unordered $argv
#    cutline_ordered $argv <&0
    typeset -a cmds
    cmds=()
    while [[ $1 =~ '^-' ]] && [[ $1 != '--' ]]; do
        
        typeset -a option_args=(${argv:2:${${argv:2}[(i)-*]}})
        print-var last_arg args
        case $1 in
            (-o|--order) cmds+=(cutline_ordered) ;;
            (-u|--unordered) cmds+=(cutline_unordered) ;;
        esac
#        shift
        shift $#args
    done
    [[ $1 == '--' ]] && shift
    
    
    print-var cmds
    return 0
}
